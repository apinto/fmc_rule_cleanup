# Example Environment Configuration for FMC Script
# Copy this file to create your own environment configuration:
# cp example.env my-production.env

# FMC Connection Settings
export FMC_HOST="192.168.1.100"
export FMC_USERNAME="your_username"
export FMC_PASSWORD="your_password"

# Device Settings
export DEVICE_NAME="firewall01.example.local"

# Operation Settings
export MAX_RULES="1000"
export AUTODEPLOY="false"  # Set to "true" to enable auto-deployment

# API Settings
export PAGE_LIMIT="500"
export TIMEOUT="10"
export DEBUG="false"  # Set to "true" for debug logging

# Zone Exclusions (space-separated list)
export EXCLUDE_ZONES="TRUSTED CRITICAL MANAGEMENT"

# IP Prefix Exclusions (space-separated list of CIDR notation)
# Exclude rules involving these IP address ranges
export EXCLUDE_PREFIXES="10.0.0.0/8 192.168.0.0/16 172.16.0.0/12"

# Prefix Match Mode
# "overlap" (default) - excludes rules with ANY network overlap (conservative, includes supersets and "any")
# "subnet" - only excludes rules where networks are subsets of excluded prefixes (strict)
export PREFIX_MATCH_MODE="overlap"

# Rule Selection Criteria
export YEAR_THRESHOLD=""  # Consider rules created before this year (default: current year - 1)
export RULE_ACTIONS="ALLOW"  # Rule actions to consider: ALLOW, BLOCK, or "ALLOW BLOCK"

# Logging
export LOG_FILE=""  # Leave empty for console logging, or set filename

# Excel Report (optional)
# Generate an Excel report with operation summary, disabled rules, and ignored rules
export EXCEL_REPORT=""  # Leave empty to skip Excel report, or set filename (e.g., "analysis_report.xlsx")

# Usage after sourcing this file:
# source my-production.env
# python3 fmc_rule_cleanup.py --host "$FMC_HOST" --username "$FMC_USERNAME" --password "$FMC_PASSWORD" --device "$DEVICE_NAME" --exclude-zones $EXCLUDE_ZONES --exclude-prefixes $EXCLUDE_PREFIXES --prefix-match-mode "$PREFIX_MATCH_MODE" --year-threshold "$YEAR_THRESHOLD" --rule-actions $RULE_ACTIONS --excel-report "$EXCEL_REPORT" --dry-run